<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>

  <!-- jQuery Mobile CSS -->
  <link rel="stylesheet"
        href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">

  <!-- jQuery Mobile JS -->
  <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

  <title>Food Voting App</title>

  <style>
    :root {
      --ghibli-cream: #f7f2e8;
      --ghibli-paper: #fff9ec;
      --ghibli-shadow: rgba(0,0,0,0.18);
      --ghibli-green: #7ea87c;
      --ghibli-red: #c96f63;
      --ghibli-brown: #8d6f55;
      --ghibli-text: #5a4a3c;

      --magic-start: #ffe9a9;
      --magic-start-dark: #d6b86f;
    }

    body, h1, h2, h3, p, div, span, a {
      font-family: "Quicksand", sans-serif !important;
      color: var(--ghibli-text);
      text-decoration: none !important;
    }

    body {
      background: var(--ghibli-cream);
    }

    body::before {
      content:"";
      position:fixed;
      top:0; left:0;
      width:100%; height:100%;
      background-image:url("https://i.imgur.com/2R8qQ7z.png");
      opacity:0.22;
      pointer-events:none;
      z-index:-1;
    }

    .ui-header {
      background: var(--ghibli-paper) !important;
      border:none !important;
      box-shadow:none !important;
    }

    .ui-title {
      font-size:26px !important;
      font-weight:700 !important;
      color:var(--ghibli-brown) !important;
    }

    /* ------------------------------------- */
    /* HOME PAGE (Version 2 + enhanced button) */
    /* ------------------------------------- */

    #homePage .ui-content {
      text-align:center;
      padding:15px 20px 40px;
    }

    #homePage .home-image {
      width:94%;
      max-width:480px;
      border-radius:18px;
      display:block;
      margin:15px auto;
      box-shadow:0 8px 20px rgba(0,0,0,0.25);
    }

    #homePage .home-title {
      font-size:34px;
      font-weight:700;
      margin-top:10px;
    }

    #homePage .home-subtitle {
      font-size:18px;
      opacity:0.85;
      margin-top:4px;
      margin-bottom:25px;
    }

    /* ------------------------------------- */
    /* BETTER ANIMATED BUTTON (MAGICAL)       */
    /* ------------------------------------- */

    .magic-btn {
      background: linear-gradient(180deg, var(--magic-start), var(--magic-start-dark));
      padding:14px 34px;
      border-radius:50px;
      color:#4d3b20 !important;
      font-weight:700;
      font-size:20px;
      display:inline-block;
      border:none;
      box-shadow:
        0 0 12px rgba(255,225,150,0.8),
        0 6px 16px rgba(0,0,0,0.22);
      animation:magicPulse 2.8s ease-in-out infinite;
      transition:transform .2s ease;
    }

    .magic-btn:hover {
      transform:translateY(-3px) scale(1.05);
      box-shadow:
        0 0 22px rgba(255,225,150,1),
        0 10px 20px rgba(0,0,0,0.28);
    }

    @keyframes magicPulse {
      0% { box-shadow:0 0 12px rgba(255,225,150,0.8); }
      50% { box-shadow:0 0 28px rgba(255,240,200,1); }
      100% { box-shadow:0 0 12px rgba(255,225,150,0.8); }
    }

    /* ------------------------------------- */
    /* RESULTS PAGE (Version 2)              */
    /* ------------------------------------- */

    .book-container {
      display:flex;
      width:90%;
      max-width:950px;
      margin:30px auto;
      background:var(--ghibli-paper);
      border-radius:14px;
      box-shadow:0px 6px 20px var(--ghibli-shadow);
      position:relative;
      overflow:hidden;
    }

    .book-spine {
      width:6px;
      background:#d8c9ab;
      box-shadow:inset 0 0 4px rgba(0,0,0,0.25);
      position:absolute;
      left:50%;
      top:0;
      bottom:0;
      transform:translateX(-50%);
    }

    .page {
      flex:1;
      padding:25px;
      background:var(--ghibli-paper);
      box-shadow:inset 0 0 20px rgba(0,0,0,0.08);
    }

    .page h2 {
      text-align:center;
      font-size:24px;
      margin-bottom:20px;
      color:var(--ghibli-brown);
    }

    .small-item {
      display:flex;
      align-items:center;
      gap:10px;
      padding:8px;
      border-radius:10px;
      cursor:pointer;
      margin-bottom:14px;
      transition:background .15s ease;
    }

    .small-item:hover {
      background:#fff4d7;
    }

    .small-item img {
      width:42px;
      height:42px;
      border-radius:8px;
      box-shadow:0px 3px 8px rgba(0,0,0,0.15);
    }

    /* ------------------------------------- */
    /* VOTING PAGE (Version 2 untouched)      */
    /* ------------------------------------- */

    .vote-card {
      background:var(--ghibli-paper);
      padding:25px;
      border-radius:18px;
      margin:40px auto;
      max-width:650px;
      border:2px solid #e6dccb;
      text-align:center;
      box-shadow:0px 6px 16px var(--ghibli-shadow);
    }

    #itemImage {
      width:100%;
      max-width:560px;
      border-radius:14px;
      margin-bottom:18px;
      box-shadow:0px 4px 10px var(--ghibli-shadow);
    }

    .arrow-area {
      display:flex;
      justify-content:space-between;
      margin-top:30px;
    }

    .arrow-left {
      background:var(--ghibli-red);
      padding:14px 28px;
      font-size:54px;
      border-radius:12px;
      color:white;
    }

    .arrow-right {
      background:var(--ghibli-green);
      padding:14px 28px;
      font-size:54px;
      border-radius:12px;
      color:white;
    }

    .slide-left { animation:slideLeft .35s forwards; }
    .slide-right { animation:slideRight .35s forwards; }

    @keyframes slideLeft {
      from { opacity:1; transform:translateX(0);}
      to { opacity:0; transform:translateX(-250px);}
    }

    @keyframes slideRight {
      from { opacity:1; transform:translateX(0);}
      to { opacity:0; transform:translateX(250px);}
    }

    .fade-in { animation:fadeIn .35s ease-out; }
    @keyframes fadeIn {
      from { opacity:0; transform:translateY(20px);}
      to { opacity:1; transform:translateY(0);}
    }

    .tap-zone {
      position:absolute;
      top:0;
      width:50%;
      height:100%;
      z-index:20;
    }

    .tap-left { left:0; }
    .tap-right { right:0; }

    /* ------------------------------------- */
    /* MODAL (UNCHANGED)                     */
    /* ------------------------------------- */

    #modalOverlay {
      position:fixed;
      bottom:0;
      left:0;
      width:100%;
      height:0;
      background:rgba(0,0,0,0.45);
      opacity:0;
      overflow:hidden;
      transition:opacity .3s ease, height .3s ease;
      z-index:999;
    }

    #modalOverlay.open {
      opacity:1;
      height:100%;
    }

    #modalCard {
      background:var(--ghibli-paper);
      position:absolute;
      bottom:-500px;
      width:100%;
      border-radius:16px 16px 0 0;
      padding:25px;
      text-align:center;
      transition:bottom .35s ease-out;
    }

    #modalOverlay.open #modalCard { bottom:0; }

    #modalImage {
      width:85%;
      max-width:420px;
      border-radius:16px;
      margin-bottom:15px;
      box-shadow:0px 6px 16px var(--ghibli-shadow);
    }
  </style>

<script>
/* -------------------------------------------------------------- */
/* FOOD DATA + STATE                                              */
/* -------------------------------------------------------------- */

const foodLore = {
  "Pizza": "A warm slice beloved across villages and cities alike.",
  "Sushi": "Crafted by patient hands in misty harbors.",
  "Pasta": "A joyful bowl cooked in kitchens full of laughter.",
  "Burrito": "Wrapped warmth for long wandering journeys.",
  "Salad": "Fresh as the morning meadow breeze.",
  "Ice Cream": "A summer delight under glowing lanterns.",
  "Ramen": "A comforting bowl for quiet rainy days.",
  "Tacos": "Vibrant flavors from bustling markets.",
  "Pancakes": "Fluffy stacks loved by early forest spirits.",
  "Fries": "Crispy bites cherished by soot sprites."
};

const items = Object.keys(foodLore);
let index = 0;
let votes = JSON.parse(localStorage.getItem("votes")) || {};

/* IMAGE PICKER */
function foodImage(item) {
  return votes[item] === "yes"
    ? `images/${item}.png`
    : `images/${item}-sad.png`;
}

/* MODAL FUNCTIONS */
function showModal(item) {
  $("#modalImage").attr("src", foodImage(item));
  $("#modalName").text(item);
  $("#modalLore").text(foodLore[item]);
  $("#modalOverlay").addClass("open");
}

function closeModal() {
  $("#modalOverlay").removeClass("open");
}

$(document).on("click", "#closeModal", closeModal);
$(document).on("click", "#modalOverlay", e => {
  if (e.target.id === "modalOverlay") closeModal();
});

/* RESET ON HOME */
$(document).on("pagebeforeshow", "#homePage", () => {
  index = 0;
  votes = {};
  localStorage.setItem("votes", JSON.stringify(votes));
});

/* SWIPE VOTING (classic Version 2 behavior) */
function animateAndVote(type) {
  let card = $(".vote-card");
  card.addClass(type === "yes" ? "slide-right" : "slide-left");

  setTimeout(() => {
    card.removeClass("slide-right slide-left");
    recordVote(type);
  }, 350);
}

function loadVotePage() {
  if (index >= items.length) {
    $.mobile.changePage("#resultsPage");
    displayResults();
    return;
  }

  const item = items[index];
  $("#itemText").text(item);
  $("#itemImage").attr("src", `images/${item}.png`);
  $("#counter").text((index + 1) + "/10");

  $(".vote-card").addClass("fade-in");
  setTimeout(() => $(".vote-card").removeClass("fade-in"), 350);
}

function recordVote(type) {
  votes[items[index]] = type;
  localStorage.setItem("votes", JSON.stringify(votes));
  index++;
  loadVotePage();
}

/* RESULTS PAGE BUILDER */
function displayResults() {
  const liked = $("#likedCol");
  const disliked = $("#dislikedCol");

  liked.empty();
  disliked.empty();

  for (let item of items) {
    const html = `
      <div class="small-item" onclick="showModal('${item}')">
        <img src="${foodImage(item)}">
        <span>${item}</span>
      </div>`;
    if (votes[item] === "yes") liked.append(html);
    else disliked.append(html);
  }
}

/* INIT */
$(document).on("pagebeforeshow", "#votePage", loadVotePage);

$(document).on("swipeleft", "#votePage", () => animateAndVote('no'));
$(document).on("swiperight", "#votePage", () => animateAndVote('yes'));

$(document).keydown(function(e){
  if ($.mobile.activePage.attr("id") !== "votePage") return;
  if (e.key === "ArrowLeft") animateAndVote('no');
  if (e.key === "ArrowRight") animateAndVote('yes');
});
</script>

</head>
<body>

<!-- HOME PAGE -->
<div data-role="page" id="homePage">

  <div data-role="content">
    <img src="images/food-vote.png" class="home-image">

    <h1 class="home-title">Food Voting</h1>
    <p class="home-subtitle">Vote for your favorite food. But beware, they might take it too personally!</p>

    <a href="#votePage" data-role="button" class="magic-btn">
      Start Your Journey
    </a>
  </div>
</div>

<!-- VOTE PAGE -->
<div data-role="page" id="votePage">

  <div class="vote-card">
    <h3 id="counter"></h3>

    <img id="itemImage" src="images/Pizza.png">
    <div id="itemText"></div>

    <div class="arrow-area">
      <div class="arrow arrow-left" onclick="animateAndVote('no')">&#8592;</div>
      <div class="arrow arrow-right" onclick="animateAndVote('yes')">&#8594;</div>
    </div>
  </div>

  <div class="tap-zone tap-left" onclick="animateAndVote('no')"></div>
  <div class="tap-zone tap-right" onclick="animateAndVote('yes')"></div>
</div>

<!-- RESULTS PAGE -->
<div data-role="page" id="resultsPage">

  <div class="book-container">
    <div class="page">
      <h2>Foods you liked</h2>
      <div id="likedCol"></div>
    </div>

    <div class="book-spine"></div>

    <div class="page">
      <h2>Foods you disliked</h2>
      <div id="dislikedCol"></div>
    </div>
  </div>

  <div style="text-align:center; padding:20px;">
    <a href="#homePage" class="magic-btn">
      Restart Journey
    </a>
  </div>
</div>

<!-- MODAL -->
<div id="modalOverlay">
  <div id="modalCard">
    <img id="modalImage">
    <b><div id="modalName"></div></b>
    <p id="modalLore"></p>
  </div>
</div>

</body>
</html>
